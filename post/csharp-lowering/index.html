<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta content="" name="keywords">
<meta content="Robert Vally" name="author">
<meta property="og:title" content="Lowering in C# - Learn Everything">
<meta property="og:url" content="https://shiver.github.io/post/csharp-lowering/">
<meta property="og:description" content="Learning everything">
<meta property="og:type" content="website" />
<title>Lowering in C# | Learn Everything</title>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&family=Karla:wght@300;400;800&display=swap" rel="stylesheet"> 


<link rel="shortcut icon" href="https://shiver.github.io//favicon.ico">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/base16/gruvbox-dark-hard.min.css">


<link rel="stylesheet" href="https://shiver.github.io//css/style.css">

</head>

<body>
<section class="section">
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <a class="nav-item" href="https://shiver.github.io/"><h1 class="back is-4">ðŸ¡ </h1></a>
      </div>
      <div class="nav-right">
        <nav class="nav-item level">
          
          <a class="level-item" href="https://github.com/shiver" target="_blank">
            <span class="icon">
              <i class="fa fa-github"></i>
            </span>
          </a>
          
          <a class="level-item" href="https://twitter.com/shivernz" target="_blank">
            <span class="icon">
              <i class="fa fa-twitter"></i>
            </span>
          </a>
          
          <a class="level-item" href="/index.xml" target="_blank">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>
          </a>
          
        </nav>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container">
    <h1 class="title">Lowering in C#</h1>
    <h2 class="subtitle is-5">August 22, 2022 by Robert Vally</h2>
    
      <div class="tags">
    
        <a class="is-link" href="/tags/csharp">csharp</a>
    
        <a class="is-link" href="/tags/performance">performance</a>
    
        <a class="is-link" href="/tags/lowering">lowering</a>
    
        <a class="is-link" href="/tags/compilers">compilers</a>
    
</div>

    
    <hr>
    <div class="content">
      <p>Understanding the performance characteristics of a C# program isn&rsquo;t always as straightforward as you might think. In much the same way as the JIT can take IL code, transform and then optimise it. Your C# code will first go through a phase where it is <code>lowered</code> before being transformed into IL.</p>
<h1 id="shortcuts">Shortcuts</h1>
<p>Rather than providing custom implementations for each syntax feature at the IL level, lowering allows the compiler authors to save a bit of time and convert that syntax into simpler constructs, which can then be transformed into IL.</p>
<p>For example, a <code>switch</code> statement can sometimes be lowered to a series of <code>if-else</code> statements instead.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Test(Things thing) 
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">switch</span> (thing)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> Things.First:
</span></span><span style="display:flex;"><span>			Console.WriteLine(<span style="color:#e6db74">&#34;First&#34;</span>);
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> Things.Second:
</span></span><span style="display:flex;"><span>			Console.WriteLine(<span style="color:#e6db74">&#34;Second&#34;</span>);
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// This is the lowered form of the above procedure</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Test(Things thing)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (thing != <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> (thing == Things.Second)
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			Console.WriteLine(<span style="color:#e6db74">&#34;Second&#34;</span>);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		Console.WriteLine(<span style="color:#e6db74">&#34;First&#34;</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>As we can see, the <code>switch</code> statement is first converted to a series of <code>if-else</code> statements before being transformed to IL. If we take a look at the resulting IL code, we can see that this step has allowed the compiler to turn the switch statement into one containing just two branching operations instead:</p>
<pre tabindex="0"><code class="language-CIL" data-lang="CIL">IL_0000: ldarg.1
IL_0001: brfalse.s IL_0008    // First branch

IL_0003: ldarg.1
IL_0004: ldc.i4.1
IL_0005: beq.s IL_0013        // Second branch

IL_0007: ret

IL_0008: ldstr &#34;First&#34;
IL_000d: call void [System.Console]System.Console::WriteLine(string)
IL_0012: ret

IL_0013: ldstr &#34;Second&#34;
IL_0018: call void [System.Console]System.Console::WriteLine(string)
IL_001d: ret
</code></pre><h1 id="optimisations">Optimisations</h1>
<p>Not all lowering is done for syntax conversion reasons though. If we add just one more case to our switch statement from before:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> TestThing(Things thing) 
</span></span><span style="display:flex;"><span>{        
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">switch</span> (thing)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> Things.First:
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> Things.Second:
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// Added case </span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> Things.Third:
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// This is the lowered form of the above procedure</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> TestThing(Things thing) 
</span></span><span style="display:flex;"><span>{        
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">switch</span> (thing)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> Things.First:
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> Things.Second:
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> Things.Third:
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>It turns out a switch statement is something that C# supports after all. If we take a look at the resulting IL code we can confirm this:</p>
<pre tabindex="0"><code class="language-CIL" data-lang="CIL">IL_0000: ldarg.1
IL_0001: switch (IL_0013, IL_001e, IL_0029)   // The switch statement

IL_0012: ret

IL_0013: ldstr &#34;First&#34;
IL_0018: call void [System.Console]System.Console::WriteLine(string)
IL_001d: ret

IL_001e: ldstr &#34;Second&#34;
IL_0023: call void [System.Console]System.Console::WriteLine(string)
IL_0028: ret

IL_0029: ldstr &#34;Third&#34;
IL_002e: call void [System.Console]System.Console::WriteLine(string)
IL_0033: ret
</code></pre><p>So if C# supports the switch statement natively, why wasn&rsquo;t it used in the first example? The answer is performance.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>BenchmarkDotNet<span style="color:#f92672">=</span>v0.13.1, OS<span style="color:#f92672">=</span>Windows 10.0.19043.1889 <span style="color:#f92672">(</span>21H1/May2021Update<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>AMD Ryzen <span style="color:#ae81ff">7</span> 5800X, <span style="color:#ae81ff">1</span> CPU, <span style="color:#ae81ff">16</span> logical and <span style="color:#ae81ff">8</span> physical cores
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span>Host<span style="color:#f92672">]</span>     : .NET Framework 4.8 <span style="color:#f92672">(</span>4.8.4515.0<span style="color:#f92672">)</span>, X86 LegacyJIT
</span></span><span style="display:flex;"><span>  DefaultJob : .NET Framework 4.8 <span style="color:#f92672">(</span>4.8.4515.0<span style="color:#f92672">)</span>, X86 LegacyJIT
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>|       Method | i |      Mean |     Error |    StdDev | Allocated |
</span></span><span style="display:flex;"><span>|------------- |-- |----------:|----------:|----------:|----------:|
</span></span><span style="display:flex;"><span>|     IfSwitch | <span style="color:#ae81ff">1</span> | 0.1992 ns | 0.0020 ns | 0.0018 ns |         - |
</span></span><span style="display:flex;"><span>| SwitchSwitch | <span style="color:#ae81ff">1</span> | 0.2166 ns | 0.0011 ns | 0.0009 ns |         - |
</span></span></code></pre></div><p><em>I added some small computation to the switch cases to avoid the compiler optimising out the instructions entirely.</em></p>
<p>The two branches in the first case are quicker as an <code>if-else</code>, but anything more than two cases the compiler will instead opt for the native <code>switch</code> instead.</p>
<p>The difference in performance for this example is negligible, however this kind of information is good to know so that you can make informed choices about the code you write.</p>
<h1 id="further-optimisations">Further Optimisations</h1>
<p>One more <code>switch</code> example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> SwitchIfString(<span style="color:#66d9ef">string</span> i)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">switch</span> (i)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;0&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;1&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;2&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;3&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;4&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;5&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// case &#34;6&#34;: break;	</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// This is the lowered form of the above procedure</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> SwitchIfString(<span style="color:#66d9ef">string</span> i)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (!(i == <span style="color:#e6db74">&#34;0&#34;</span>) &amp;&amp; !(i == <span style="color:#e6db74">&#34;1&#34;</span>) &amp;&amp; !(i == <span style="color:#e6db74">&#34;2&#34;</span>) &amp;&amp; !(i == <span style="color:#e6db74">&#34;3&#34;</span>) &amp;&amp; !(i == <span style="color:#e6db74">&#34;4&#34;</span>))
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">bool</span> flag = i == <span style="color:#e6db74">&#34;5&#34;</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>We have some slightly different behaviour again. By changing the data type from an integer/enum to a string, the compiler opts to use a construct that is likely to yield better performance instead.</p>
<p>For even more interesting results we can add in just one more <code>case</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> SwitchHashString(<span style="color:#66d9ef">string</span> i)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">switch</span> (i)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;0&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;1&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;2&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;3&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;4&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;5&#34;</span>: <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;6&#34;</span>: <span style="color:#66d9ef">break</span>;	
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// This is the lowered form of the above procedure</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> SwitchHashString(<span style="color:#66d9ef">string</span> i)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">uint</span> num = &lt;PrivateImplementationDetails&gt;.ComputeStringHash(i);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (num &lt;= <span style="color:#ae81ff">856466825</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> (num != <span style="color:#ae81ff">806133968</span>)
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span> (num != <span style="color:#ae81ff">822911587</span>)
</span></span><span style="display:flex;"><span>			{
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span> (num == <span style="color:#ae81ff">856466825</span>)
</span></span><span style="display:flex;"><span>				{
</span></span><span style="display:flex;"><span>					<span style="color:#66d9ef">bool</span> flag = i == <span style="color:#e6db74">&#34;6&#34;</span>;
</span></span><span style="display:flex;"><span>				}
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>			{
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">bool</span> flag2 = i == <span style="color:#e6db74">&#34;4&#34;</span>;
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">bool</span> flag3 = i == <span style="color:#e6db74">&#34;5&#34;</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (num &lt;= <span style="color:#ae81ff">890022063</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> (num != <span style="color:#ae81ff">873244444</span>)
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span> (num == <span style="color:#ae81ff">890022063</span>)
</span></span><span style="display:flex;"><span>			{
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">bool</span> flag4 = i == <span style="color:#e6db74">&#34;0&#34;</span>;
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">bool</span> flag5 = i == <span style="color:#e6db74">&#34;1&#34;</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (num != <span style="color:#ae81ff">906799682</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> (num == <span style="color:#ae81ff">923577301</span>)
</span></span><span style="display:flex;"><span>		{
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">bool</span> flag6 = i == <span style="color:#e6db74">&#34;2&#34;</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">bool</span> flag7 = i == <span style="color:#e6db74">&#34;3&#34;</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>A somewhat surprising turn of events perhaps and a completely new construct. Instead of a <code>switch</code> or a simple <code>if-else</code> block, the comparisons have instead morphed into a graph of <code>if-else</code> statements performed on a hash of the string value.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>|           Method | i | k |     Mean |     Error |    StdDev | Allocated |
</span></span><span style="display:flex;"><span>|----------------- |-- |-- |---------:|----------:|----------:|----------:|
</span></span><span style="display:flex;"><span>|   SwitchIfString | <span style="color:#ae81ff">1</span> | <span style="color:#ae81ff">1</span> | 4.591 ns | 0.0593 ns | 0.0555 ns |         - |
</span></span><span style="display:flex;"><span>| SwitchHashString | <span style="color:#ae81ff">1</span> | <span style="color:#ae81ff">1</span> | 2.961 ns | 0.0130 ns | 0.0121 ns |         - |
</span></span></code></pre></div><p>Interestingly the benchmarks show the <code>if-else</code> block being slightly slower than the hash. However, given the numbers we&rsquo;re working with here I wouldn&rsquo;t read too much into it. Perhaps different hardware and situations will change the results, or perhaps my benchmark isn&rsquo;t quite right.</p>
<p>It is worth noting that microbenchmarks such as these are not indicative of too much, and they were not the purpose of this article. What is important though is that you have some understanding that the code you are writing can sometimes not behave in the manner that you would expect, given that the compiler may &ldquo;<em>lower</em>&rdquo; your syntax into another form. Knowing this gives you the perspective to delve deeper to fully understand the problems when they arise.</p>
<p>As a further exercise I suggest taking a look at how async code is turned into a state machine when it is lowered:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Diagnostics;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Reflection;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Runtime.CompilerServices;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Runtime.InteropServices;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Security;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Security.Permissions;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">using</span> System.Threading.Tasks;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">
</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">[assembly: CompilationRelaxations(8)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[assembly: RuntimeCompatibility(WrapNonExceptionThrows = true)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[assembly: Debuggable(DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[assembly: SecurityPermission(SecurityAction.RequestMinimum, SkipVerification = true)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[assembly: AssemblyVersion(&#34;0.0.0.0&#34;)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[module: UnverifiableCode]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">C</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">    [StructLayout(LayoutKind.Auto)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">    [CompilerGenerated]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">struct</span> &lt;TestAsync&gt;d__0 : IAsyncStateMachine
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> &lt;&gt;<span style="color:#ae81ff">1__</span>state;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> AsyncTaskMethodBuilder &lt;&gt;t__builder;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> TaskAwaiter &lt;&gt;u__1;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> MoveNext()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> num = &lt;&gt;<span style="color:#ae81ff">1__</span>state;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                TaskAwaiter awaiter;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (num != <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    awaiter = Task.Delay(<span style="color:#ae81ff">10</span>).GetAwaiter();
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> (!awaiter.IsCompleted)
</span></span><span style="display:flex;"><span>                    {
</span></span><span style="display:flex;"><span>                        num = (&lt;&gt;<span style="color:#ae81ff">1__</span>state = <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>                        &lt;&gt;u__1 = awaiter;
</span></span><span style="display:flex;"><span>                        &lt;&gt;t__builder.AwaitUnsafeOnCompleted(<span style="color:#66d9ef">ref</span> awaiter, <span style="color:#66d9ef">ref</span> <span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    awaiter = &lt;&gt;u__1;
</span></span><span style="display:flex;"><span>                    &lt;&gt;u__1 = <span style="color:#66d9ef">default</span>(TaskAwaiter);
</span></span><span style="display:flex;"><span>                    num = (&lt;&gt;<span style="color:#ae81ff">1__</span>state = -<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                awaiter.GetResult();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">catch</span> (Exception exception)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                &lt;&gt;<span style="color:#ae81ff">1__</span>state = -<span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>                &lt;&gt;t__builder.SetException(exception);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            &lt;&gt;<span style="color:#ae81ff">1__</span>state = -<span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>            &lt;&gt;t__builder.SetResult();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">void</span> IAsyncStateMachine.MoveNext()
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//ILSpy generated this explicit interface implementation from .override directive in MoveNext</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.MoveNext();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">
</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">        [DebuggerHidden]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> SetStateMachine(IAsyncStateMachine stateMachine)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            &lt;&gt;t__builder.SetStateMachine(stateMachine);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">void</span> IAsyncStateMachine.SetStateMachine(IAsyncStateMachine stateMachine)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//ILSpy generated this explicit interface implementation from .override directive in SetStateMachine</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.SetStateMachine(stateMachine);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">
</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">    [AsyncStateMachine(typeof(&lt;TestAsync&gt;d__0))]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Task TestAsync()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        &lt;TestAsync&gt;d__0 stateMachine = <span style="color:#66d9ef">default</span>(&lt;TestAsync&gt;d__0);
</span></span><span style="display:flex;"><span>        stateMachine.&lt;&gt;t__builder = AsyncTaskMethodBuilder.Create();
</span></span><span style="display:flex;"><span>        stateMachine.&lt;&gt;<span style="color:#ae81ff">1__</span>state = -<span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        stateMachine.&lt;&gt;t__builder.Start(<span style="color:#66d9ef">ref</span> stateMachine);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> stateMachine.&lt;&gt;t__builder.Task;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h3 id="references">References:</h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Common_Intermediate_Language">Common Intermediate Language</a></li>
<li>An excellent <a href="https://www.youtube.com/watch?v=3oGBMGDRXVw">video</a> by <a href="https://www.youtube.com/c/Elfocrash">Nick Chapsas</a> which covers some of the same ground as this article.</li>
<li><a href="https://sharplab.io">sharplab.io</a> used to convert C# code to its lowered form.</li>
<li><a href="https://benchmarkdotnet.org">BenchmarkDotNet</a> used to create the benchmarks shown in this article.</li>
</ul>

    </div>
    
    <div class="nav-center">
    <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fshiver.github.io%2fpost%2fcsharp-lowering%2f" title="Share on Facebook" target="_blank"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
    <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fshiver.github.io%2fpost%2fcsharp-lowering%2f" title="Share on LinkedIn" target="_blank"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
    <a class="nav-item" href="https://twitter.com/home?status=Lowering%20in%20C%23 - https%3a%2f%2fshiver.github.io%2fpost%2fcsharp-lowering%2f" title="Tweet this" target="_blank"><span class="fa fa-twitter fa-2x"></span></a>
    <a class="nav-item" href="http://www.reddit.com/submit?url=https%3a%2f%2fshiver.github.io%2fpost%2fcsharp-lowering%2f&title=Lowering%20in%20C%23" title="Share on Reddit" target="_blank"><span class="fa fa-reddit-alien fa-2x" aria-hidden="true"></span></a>
    <a class="nav-item" href="mailto:?subject=Lowering%20in%20C%23&body=%3cp%3eUnderstanding%20the%20performance%20characteristics%20of%20a%20C%23%20program%20isn%26rsquo%3bt%20always%20as%20straightforward%20as%20you%20might%20think.%20In%20much%20the%20same%20way%20as%20the%20JIT%20can%20take%20IL%20code%2c%20transform%20and%20then%20optimise%20it.%20Your%20C%23%20code%20will%20first%20go%20through%20a%20phase%20where%20it%20is%20%3ccode%3elowered%3c%2fcode%3e%20before%20being%20transformed%20into%20IL.%3c%2fp%3e%0a%3ch1%20id%3d%22shortcuts%22%3eShortcuts%3c%2fh1%3e%0a%3cp%3eRather%20than%20providing%20custom%20implementations%20for%20each%20syntax%20feature%20at%20the%20IL%20level%2c%20lowering%20allows%20the%20compiler%20authors%20to%20save%20a%20bit%20of%20time%20and%20convert%20that%20syntax%20into%20simpler%20constructs%2c%20which%20can%20then%20be%20transformed%20into%20IL.%3c%2fp%3e%0a%3cp%3eFor%20example%2c%20a%20%3ccode%3eswitch%3c%2fcode%3e%20statement%20can%20sometimes%20be%20lowered%20to%20a%20series%20of%20%3ccode%3eif-else%3c%2fcode%3e%20statements%20instead.%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-C%23%22%20data-lang%3d%22C%23%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20Test%28Things%20thing%29%20%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eswitch%3c%2fspan%3e%20%28thing%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20Things.First%3a%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09Console.WriteLine%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bFirst%26%2334%3b%3c%2fspan%3e%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20Things.Second%3a%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09Console.WriteLine%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bSecond%26%2334%3b%3c%2fspan%3e%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%2f%2f%20This%20is%20the%20lowered%20form%20of%20the%20above%20procedure%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20Test%28Things%20thing%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28thing%20%21%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e0%3c%2fspan%3e%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28thing%20%3d%3d%20Things.Second%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09Console.WriteLine%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bSecond%26%2334%3b%3c%2fspan%3e%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eelse%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09Console.WriteLine%28%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3bFirst%26%2334%3b%3c%2fspan%3e%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2fdiv%3e%3cp%3eAs%20we%20can%20see%2c%20the%20%3ccode%3eswitch%3c%2fcode%3e%20statement%20is%20first%20converted%20to%20a%20series%20of%20%3ccode%3eif-else%3c%2fcode%3e%20statements%20before%20being%20transformed%20to%20IL.%20If%20we%20take%20a%20look%20at%20the%20resulting%20IL%20code%2c%20we%20can%20see%20that%20this%20step%20has%20allowed%20the%20compiler%20to%20turn%20the%20switch%20statement%20into%20one%20containing%20just%20two%20branching%20operations%20instead%3a%3c%2fp%3e%0a%3cpre%20tabindex%3d%220%22%3e%3ccode%20class%3d%22language-CIL%22%20data-lang%3d%22CIL%22%3eIL_0000%3a%20ldarg.1%0d%0aIL_0001%3a%20brfalse.s%20IL_0008%20%20%20%20%2f%2f%20First%20branch%0d%0a%0d%0aIL_0003%3a%20ldarg.1%0d%0aIL_0004%3a%20ldc.i4.1%0d%0aIL_0005%3a%20beq.s%20IL_0013%20%20%20%20%20%20%20%20%2f%2f%20Second%20branch%0d%0a%0d%0aIL_0007%3a%20ret%0d%0a%0d%0aIL_0008%3a%20ldstr%20%26%2334%3bFirst%26%2334%3b%0d%0aIL_000d%3a%20call%20void%20%5bSystem.Console%5dSystem.Console%3a%3aWriteLine%28string%29%0d%0aIL_0012%3a%20ret%0d%0a%0d%0aIL_0013%3a%20ldstr%20%26%2334%3bSecond%26%2334%3b%0d%0aIL_0018%3a%20call%20void%20%5bSystem.Console%5dSystem.Console%3a%3aWriteLine%28string%29%0d%0aIL_001d%3a%20ret%0a%3c%2fcode%3e%3c%2fpre%3e%3ch1%20id%3d%22optimisations%22%3eOptimisations%3c%2fh1%3e%0a%3cp%3eNot%20all%20lowering%20is%20done%20for%20syntax%20conversion%20reasons%20though.%20If%20we%20add%20just%20one%20more%20case%20to%20our%20switch%20statement%20from%20before%3a%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-C%23%22%20data-lang%3d%22C%23%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20TestThing%28Things%20thing%29%20%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7b%20%20%20%20%20%20%20%20%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eswitch%3c%2fspan%3e%20%28thing%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20Things.First%3a%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20Things.Second%3a%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2375715e%22%3e%2f%2f%20Added%20case%20%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20Things.Third%3a%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%2f%2f%20This%20is%20the%20lowered%20form%20of%20the%20above%20procedure%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20TestThing%28Things%20thing%29%20%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7b%20%20%20%20%20%20%20%20%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eswitch%3c%2fspan%3e%20%28thing%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20Things.First%3a%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20Things.Second%3a%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20Things.Third%3a%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2fdiv%3e%3cp%3eIt%20turns%20out%20a%20switch%20statement%20is%20something%20that%20C%23%20supports%20after%20all.%20If%20we%20take%20a%20look%20at%20the%20resulting%20IL%20code%20we%20can%20confirm%20this%3a%3c%2fp%3e%0a%3cpre%20tabindex%3d%220%22%3e%3ccode%20class%3d%22language-CIL%22%20data-lang%3d%22CIL%22%3eIL_0000%3a%20ldarg.1%0d%0aIL_0001%3a%20switch%20%28IL_0013%2c%20IL_001e%2c%20IL_0029%29%20%20%20%2f%2f%20The%20switch%20statement%0d%0a%0d%0aIL_0012%3a%20ret%0d%0a%0d%0aIL_0013%3a%20ldstr%20%26%2334%3bFirst%26%2334%3b%0d%0aIL_0018%3a%20call%20void%20%5bSystem.Console%5dSystem.Console%3a%3aWriteLine%28string%29%0d%0aIL_001d%3a%20ret%0d%0a%0d%0aIL_001e%3a%20ldstr%20%26%2334%3bSecond%26%2334%3b%0d%0aIL_0023%3a%20call%20void%20%5bSystem.Console%5dSystem.Console%3a%3aWriteLine%28string%29%0d%0aIL_0028%3a%20ret%0d%0a%0d%0aIL_0029%3a%20ldstr%20%26%2334%3bThird%26%2334%3b%0d%0aIL_002e%3a%20call%20void%20%5bSystem.Console%5dSystem.Console%3a%3aWriteLine%28string%29%0d%0aIL_0033%3a%20ret%0a%3c%2fcode%3e%3c%2fpre%3e%3cp%3eSo%20if%20C%23%20supports%20the%20switch%20statement%20natively%2c%20why%20wasn%26rsquo%3bt%20it%20used%20in%20the%20first%20example%3f%20The%20answer%20is%20performance.%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-shell%22%20data-lang%3d%22shell%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3eBenchmarkDotNet%3cspan%20style%3d%22color%3a%23f92672%22%3e%3d%3c%2fspan%3ev0.13.1%2c%20OS%3cspan%20style%3d%22color%3a%23f92672%22%3e%3d%3c%2fspan%3eWindows%2010.0.19043.1889%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%28%3c%2fspan%3e21H1%2fMay2021Update%3cspan%20style%3d%22color%3a%23f92672%22%3e%29%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3eAMD%20Ryzen%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e7%3c%2fspan%3e%205800X%2c%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1%3c%2fspan%3e%20CPU%2c%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e16%3c%2fspan%3e%20logical%20and%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e8%3c%2fspan%3e%20physical%20cores%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%5b%3c%2fspan%3eHost%3cspan%20style%3d%22color%3a%23f92672%22%3e%5d%3c%2fspan%3e%20%20%20%20%20%3a%20.NET%20Framework%204.8%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%28%3c%2fspan%3e4.8.4515.0%3cspan%20style%3d%22color%3a%23f92672%22%3e%29%3c%2fspan%3e%2c%20X86%20LegacyJIT%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20DefaultJob%20%3a%20.NET%20Framework%204.8%20%3cspan%20style%3d%22color%3a%23f92672%22%3e%28%3c%2fspan%3e4.8.4515.0%3cspan%20style%3d%22color%3a%23f92672%22%3e%29%3c%2fspan%3e%2c%20X86%20LegacyJIT%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7c%20%20%20%20%20%20%20Method%20%7c%20i%20%7c%20%20%20%20%20%20Mean%20%7c%20%20%20%20%20Error%20%7c%20%20%20%20StdDev%20%7c%20Allocated%20%7c%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7c-------------%20%7c--%20%7c----------%3a%7c----------%3a%7c----------%3a%7c----------%3a%7c%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7c%20%20%20%20%20IfSwitch%20%7c%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1%3c%2fspan%3e%20%7c%200.1992%20ns%20%7c%200.0020%20ns%20%7c%200.0018%20ns%20%7c%20%20%20%20%20%20%20%20%20-%20%7c%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7c%20SwitchSwitch%20%7c%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1%3c%2fspan%3e%20%7c%200.2166%20ns%20%7c%200.0011%20ns%20%7c%200.0009%20ns%20%7c%20%20%20%20%20%20%20%20%20-%20%7c%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2fdiv%3e%3cp%3e%3cem%3eI%20added%20some%20small%20computation%20to%20the%20switch%20cases%20to%20avoid%20the%20compiler%20optimising%20out%20the%20instructions%20entirely.%3c%2fem%3e%3c%2fp%3e%0a%3cp%3eThe%20two%20branches%20in%20the%20first%20case%20are%20quicker%20as%20an%20%3ccode%3eif-else%3c%2fcode%3e%2c%20but%20anything%20more%20than%20two%20cases%20the%20compiler%20will%20instead%20opt%20for%20the%20native%20%3ccode%3eswitch%3c%2fcode%3e%20instead.%3c%2fp%3e%0a%3cp%3eThe%20difference%20in%20performance%20for%20this%20example%20is%20negligible%2c%20however%20this%20kind%20of%20information%20is%20good%20to%20know%20so%20that%20you%20can%20make%20informed%20choices%20about%20the%20code%20you%20write.%3c%2fp%3e%0a%3ch1%20id%3d%22further-optimisations%22%3eFurther%20Optimisations%3c%2fh1%3e%0a%3cp%3eOne%20more%20%3ccode%3eswitch%3c%2fcode%3e%20example%3a%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-C%23%22%20data-lang%3d%22C%23%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20SwitchIfString%28%3cspan%20style%3d%22color%3a%2366d9ef%22%3estring%3c%2fspan%3e%20i%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eswitch%3c%2fspan%3e%20%28i%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b0%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b1%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b2%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b3%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b4%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b5%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2375715e%22%3e%2f%2f%20case%20%26%2334%3b6%26%2334%3b%3a%20break%3b%09%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%2f%2f%20This%20is%20the%20lowered%20form%20of%20the%20above%20procedure%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20SwitchIfString%28%3cspan%20style%3d%22color%3a%2366d9ef%22%3estring%3c%2fspan%3e%20i%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28%21%28i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b0%26%2334%3b%3c%2fspan%3e%29%20%26amp%3b%26amp%3b%20%21%28i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b1%26%2334%3b%3c%2fspan%3e%29%20%26amp%3b%26amp%3b%20%21%28i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b2%26%2334%3b%3c%2fspan%3e%29%20%26amp%3b%26amp%3b%20%21%28i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b3%26%2334%3b%3c%2fspan%3e%29%20%26amp%3b%26amp%3b%20%21%28i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b4%26%2334%3b%3c%2fspan%3e%29%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebool%3c%2fspan%3e%20flag%20%3d%20i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b5%26%2334%3b%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2fdiv%3e%3cp%3eWe%20have%20some%20slightly%20different%20behaviour%20again.%20By%20changing%20the%20data%20type%20from%20an%20integer%2fenum%20to%20a%20string%2c%20the%20compiler%20opts%20to%20use%20a%20construct%20that%20is%20likely%20to%20yield%20better%20performance%20instead.%3c%2fp%3e%0a%3cp%3eFor%20even%20more%20interesting%20results%20we%20can%20add%20in%20just%20one%20more%20%3ccode%3ecase%3c%2fcode%3e%3a%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-C%23%22%20data-lang%3d%22C%23%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20SwitchHashString%28%3cspan%20style%3d%22color%3a%2366d9ef%22%3estring%3c%2fspan%3e%20i%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eswitch%3c%2fspan%3e%20%28i%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b0%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b1%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b2%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b3%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b4%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b5%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecase%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b6%26%2334%3b%3c%2fspan%3e%3a%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebreak%3c%2fspan%3e%3b%09%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2375715e%22%3e%2f%2f%20This%20is%20the%20lowered%20form%20of%20the%20above%20procedure%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20SwitchHashString%28%3cspan%20style%3d%22color%3a%2366d9ef%22%3estring%3c%2fspan%3e%20i%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3euint%3c%2fspan%3e%20num%20%3d%20%26lt%3bPrivateImplementationDetails%26gt%3b.ComputeStringHash%28i%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28num%20%26lt%3b%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e856466825%3c%2fspan%3e%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28num%20%21%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e806133968%3c%2fspan%3e%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28num%20%21%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e822911587%3c%2fspan%3e%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28num%20%3d%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e856466825%3c%2fspan%3e%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebool%3c%2fspan%3e%20flag%20%3d%20i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b6%26%2334%3b%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eelse%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebool%3c%2fspan%3e%20flag2%20%3d%20i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b4%26%2334%3b%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eelse%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebool%3c%2fspan%3e%20flag3%20%3d%20i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b5%26%2334%3b%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eelse%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28num%20%26lt%3b%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e890022063%3c%2fspan%3e%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28num%20%21%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e873244444%3c%2fspan%3e%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28num%20%3d%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e890022063%3c%2fspan%3e%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebool%3c%2fspan%3e%20flag4%20%3d%20i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b0%26%2334%3b%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eelse%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebool%3c%2fspan%3e%20flag5%20%3d%20i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b1%26%2334%3b%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eelse%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28num%20%21%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e906799682%3c%2fspan%3e%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28num%20%3d%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e923577301%3c%2fspan%3e%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebool%3c%2fspan%3e%20flag6%20%3d%20i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b2%26%2334%3b%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3eelse%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%09%3cspan%20style%3d%22color%3a%2366d9ef%22%3ebool%3c%2fspan%3e%20flag7%20%3d%20i%20%3d%3d%20%3cspan%20style%3d%22color%3a%23e6db74%22%3e%26%2334%3b3%26%2334%3b%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%09%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2fdiv%3e%3cp%3eA%20somewhat%20surprising%20turn%20of%20events%20perhaps%20and%20a%20completely%20new%20construct.%20Instead%20of%20a%20%3ccode%3eswitch%3c%2fcode%3e%20or%20a%20simple%20%3ccode%3eif-else%3c%2fcode%3e%20block%2c%20the%20comparisons%20have%20instead%20morphed%20into%20a%20graph%20of%20%3ccode%3eif-else%3c%2fcode%3e%20statements%20performed%20on%20a%20hash%20of%20the%20string%20value.%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-shell%22%20data-lang%3d%22shell%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7c%20%20%20%20%20%20%20%20%20%20%20Method%20%7c%20i%20%7c%20k%20%7c%20%20%20%20%20Mean%20%7c%20%20%20%20%20Error%20%7c%20%20%20%20StdDev%20%7c%20Allocated%20%7c%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7c-----------------%20%7c--%20%7c--%20%7c---------%3a%7c----------%3a%7c----------%3a%7c----------%3a%7c%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7c%20%20%20SwitchIfString%20%7c%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1%3c%2fspan%3e%20%7c%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1%3c%2fspan%3e%20%7c%204.591%20ns%20%7c%200.0593%20ns%20%7c%200.0555%20ns%20%7c%20%20%20%20%20%20%20%20%20-%20%7c%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7c%20SwitchHashString%20%7c%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1%3c%2fspan%3e%20%7c%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1%3c%2fspan%3e%20%7c%202.961%20ns%20%7c%200.0130%20ns%20%7c%200.0121%20ns%20%7c%20%20%20%20%20%20%20%20%20-%20%7c%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2fdiv%3e%3cp%3eInterestingly%20the%20benchmarks%20show%20the%20%3ccode%3eif-else%3c%2fcode%3e%20block%20being%20slightly%20slower%20than%20the%20hash.%20However%2c%20given%20the%20numbers%20we%26rsquo%3bre%20working%20with%20here%20I%20wouldn%26rsquo%3bt%20read%20too%20much%20into%20it.%20Perhaps%20different%20hardware%20and%20situations%20will%20change%20the%20results%2c%20or%20perhaps%20my%20benchmark%20isn%26rsquo%3bt%20quite%20right.%3c%2fp%3e%0a%3cp%3eIt%20is%20worth%20noting%20that%20microbenchmarks%20such%20as%20these%20are%20not%20indicative%20of%20too%20much%2c%20and%20they%20were%20not%20the%20purpose%20of%20this%20article.%20What%20is%20important%20though%20is%20that%20you%20have%20some%20understanding%20that%20the%20code%20you%20are%20writing%20can%20sometimes%20not%20behave%20in%20the%20manner%20that%20you%20would%20expect%2c%20given%20that%20the%20compiler%20may%20%26ldquo%3b%3cem%3elower%3c%2fem%3e%26rdquo%3b%20your%20syntax%20into%20another%20form.%20Knowing%20this%20gives%20you%20the%20perspective%20to%20delve%20deeper%20to%20fully%20understand%20the%20problems%20when%20they%20arise.%3c%2fp%3e%0a%3cp%3eAs%20a%20further%20exercise%20I%20suggest%20taking%20a%20look%20at%20how%20async%20code%20is%20turned%20into%20a%20state%20machine%20when%20it%20is%20lowered%3a%3c%2fp%3e%0a%3cdiv%20class%3d%22highlight%22%3e%3cpre%20tabindex%3d%220%22%20style%3d%22color%3a%23f8f8f2%3bbackground-color%3a%23272822%3b-moz-tab-size%3a4%3b-o-tab-size%3a4%3btab-size%3a4%3b%22%3e%3ccode%20class%3d%22language-C%23%22%20data-lang%3d%22C%23%22%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3eusing%3c%2fspan%3e%20System%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3eusing%3c%2fspan%3e%20System.Diagnostics%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3eusing%3c%2fspan%3e%20System.Reflection%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3eusing%3c%2fspan%3e%20System.Runtime.CompilerServices%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3eusing%3c%2fspan%3e%20System.Runtime.InteropServices%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3eusing%3c%2fspan%3e%20System.Security%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3eusing%3c%2fspan%3e%20System.Security.Permissions%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3eusing%3c%2fspan%3e%20System.Threading.Tasks%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%5bassembly%3a%20CompilationRelaxations%288%29%5d%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%5bassembly%3a%20RuntimeCompatibility%28WrapNonExceptionThrows%20%3d%20true%29%5d%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%5bassembly%3a%20Debuggable%28DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints%29%5d%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%5bassembly%3a%20SecurityPermission%28SecurityAction.RequestMinimum%2c%20SkipVerification%20%3d%20true%29%5d%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%5bassembly%3a%20AssemblyVersion%28%26%2334%3b0.0.0.0%26%2334%3b%29%5d%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%5bmodule%3a%20UnverifiableCode%5d%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eclass%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%23a6e22e%22%3eC%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%20%20%20%20%5bStructLayout%28LayoutKind.Auto%29%5d%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%20%20%20%20%5bCompilerGenerated%5d%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eprivate%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3estruct%3c%2fspan%3e%20%26lt%3bTestAsync%26gt%3bd__0%20%3a%20IAsyncStateMachine%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eint%3c%2fspan%3e%20%26lt%3b%26gt%3b%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1__%3c%2fspan%3estate%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20AsyncTaskMethodBuilder%20%26lt%3b%26gt%3bt__builder%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eprivate%3c%2fspan%3e%20TaskAwaiter%20%26lt%3b%26gt%3bu__1%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eprivate%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20MoveNext%28%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eint%3c%2fspan%3e%20num%20%3d%20%26lt%3b%26gt%3b%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1__%3c%2fspan%3estate%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3etry%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20TaskAwaiter%20awaiter%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28num%20%21%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e0%3c%2fspan%3e%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20awaiter%20%3d%20Task.Delay%28%3cspan%20style%3d%22color%3a%23ae81ff%22%3e10%3c%2fspan%3e%29.GetAwaiter%28%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eif%3c%2fspan%3e%20%28%21awaiter.IsCompleted%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20num%20%3d%20%28%26lt%3b%26gt%3b%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1__%3c%2fspan%3estate%20%3d%20%3cspan%20style%3d%22color%3a%23ae81ff%22%3e0%3c%2fspan%3e%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26lt%3b%26gt%3bu__1%20%3d%20awaiter%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26lt%3b%26gt%3bt__builder.AwaitUnsafeOnCompleted%28%3cspan%20style%3d%22color%3a%2366d9ef%22%3eref%3c%2fspan%3e%20awaiter%2c%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eref%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ethis%3c%2fspan%3e%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ereturn%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eelse%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20awaiter%20%3d%20%26lt%3b%26gt%3bu__1%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26lt%3b%26gt%3bu__1%20%3d%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3edefault%3c%2fspan%3e%28TaskAwaiter%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20num%20%3d%20%28%26lt%3b%26gt%3b%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1__%3c%2fspan%3estate%20%3d%20-%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1%3c%2fspan%3e%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20awaiter.GetResult%28%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ecatch%3c%2fspan%3e%20%28Exception%20exception%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26lt%3b%26gt%3b%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1__%3c%2fspan%3estate%20%3d%20-%3cspan%20style%3d%22color%3a%23ae81ff%22%3e2%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26lt%3b%26gt%3bt__builder.SetException%28exception%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ereturn%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%26lt%3b%26gt%3b%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1__%3c%2fspan%3estate%20%3d%20-%3cspan%20style%3d%22color%3a%23ae81ff%22%3e2%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%26lt%3b%26gt%3bt__builder.SetResult%28%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20IAsyncStateMachine.MoveNext%28%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2375715e%22%3e%2f%2fILSpy%20generated%20this%20explicit%20interface%20implementation%20from%20.override%20directive%20in%20MoveNext%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ethis%3c%2fspan%3e.MoveNext%28%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%20%20%20%20%20%20%20%20%5bDebuggerHidden%5d%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3eprivate%3c%2fspan%3e%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20SetStateMachine%28IAsyncStateMachine%20stateMachine%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%26lt%3b%26gt%3bt__builder.SetStateMachine%28stateMachine%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3evoid%3c%2fspan%3e%20IAsyncStateMachine.SetStateMachine%28IAsyncStateMachine%20stateMachine%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2375715e%22%3e%2f%2fILSpy%20generated%20this%20explicit%20interface%20implementation%20from%20.override%20directive%20in%20SetStateMachine%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ethis%3c%2fspan%3e.SetStateMachine%28stateMachine%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%3cspan%20style%3d%22color%3a%23a6e22e%22%3e%20%20%20%20%5bAsyncStateMachine%28typeof%28%26lt%3bTestAsync%26gt%3bd__0%29%29%5d%3c%2fspan%3e%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3epublic%3c%2fspan%3e%20Task%20TestAsync%28%29%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%7b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%26lt%3bTestAsync%26gt%3bd__0%20stateMachine%20%3d%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3edefault%3c%2fspan%3e%28%26lt%3bTestAsync%26gt%3bd__0%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20stateMachine.%26lt%3b%26gt%3bt__builder%20%3d%20AsyncTaskMethodBuilder.Create%28%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20stateMachine.%26lt%3b%26gt%3b%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1__%3c%2fspan%3estate%20%3d%20-%3cspan%20style%3d%22color%3a%23ae81ff%22%3e1%3c%2fspan%3e%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20stateMachine.%26lt%3b%26gt%3bt__builder.Start%28%3cspan%20style%3d%22color%3a%2366d9ef%22%3eref%3c%2fspan%3e%20stateMachine%29%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%20%20%20%20%3cspan%20style%3d%22color%3a%2366d9ef%22%3ereturn%3c%2fspan%3e%20stateMachine.%26lt%3b%26gt%3bt__builder.Task%3b%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%20%20%20%20%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3cspan%20style%3d%22display%3aflex%3b%22%3e%3cspan%3e%7d%0a%3c%2fspan%3e%3c%2fspan%3e%3c%2fcode%3e%3c%2fpre%3e%3c%2fdiv%3e%3chr%3e%0a%3ch3%20id%3d%22references%22%3eReferences%3a%3c%2fh3%3e%0a%3cul%3e%0a%3cli%3e%3ca%20href%3d%22https%3a%2f%2fen.wikipedia.org%2fwiki%2fCommon_Intermediate_Language%22%3eCommon%20Intermediate%20Language%3c%2fa%3e%3c%2fli%3e%0a%3cli%3eAn%20excellent%20%3ca%20href%3d%22https%3a%2f%2fwww.youtube.com%2fwatch%3fv%3d3oGBMGDRXVw%22%3evideo%3c%2fa%3e%20by%20%3ca%20href%3d%22https%3a%2f%2fwww.youtube.com%2fc%2fElfocrash%22%3eNick%20Chapsas%3c%2fa%3e%20which%20covers%20some%20of%20the%20same%20ground%20as%20this%20article.%3c%2fli%3e%0a%3cli%3e%3ca%20href%3d%22https%3a%2f%2fsharplab.io%22%3esharplab.io%3c%2fa%3e%20used%20to%20convert%20C%23%20code%20to%20its%20lowered%20form.%3c%2fli%3e%0a%3cli%3e%3ca%20href%3d%22https%3a%2f%2fbenchmarkdotnet.org%22%3eBenchmarkDotNet%3c%2fa%3e%20used%20to%20create%20the%20benchmarks%20shown%20in%20this%20article.%3c%2fli%3e%0a%3c%2ful%3e%0a" title="Share via Email" target="_blank"><span class="fa fa-envelope fa-2x" aria-hidden="true"></span></a>
</div>
    
  </div>
</section>


<section class="section">
  <div class="container has-text-centered">
    <p>&copy; 2022 | Follow on <a class="follow-item" href="https://twitter.com/shivernz" target="_blank">Twitter</a> | <a class="follow-item" href="https://github.com/shiver" target="_blank">GitHub</a></p>
  </div>
</section>


<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js" integrity="sha512-gU7kztaQEl7SHJyraPfZLQCNnrKdaQi5ndOyt4L4UPL/FHDd/uB9Je6KDARIqwnNNE27hnqoWLBq+Kpe4iHfeQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/c.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/cpp.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/csharp.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/rust.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/python.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/php.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/javascript.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/css.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/typescript.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>

<script>hljs.initHighlightingOnLoad();</script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-146427172-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</body>
